<!-- :deciduous_tree: :heavy_check_mark: 
https://gist.github.com/rxaviers/7360908#file-gistfile1-md
:paw_prints:
:deciduous_tree: **инструкция для демо-режима**
:bookmark:
:heavy_exclamation_mark:
:memo: 
-->

[![яндекс касса](/i/yakassalogo.png "Яндекс Касса")](https://kassa.yandex.ru) / документация / [http](/demo/010%20интеграция%20для%20самописных%20сайтов.md), [cms](/demo/011%20интеграция%20для%20CMS%20и%20SaaS.md), [email](/010%20интеграция%20email.md), [тестирование](/demo/030%20тестирование.md):arrow_left:, [решение ошибок](/demo/031%20решение%20ошибок.md), [демо](/demo/032%20демо%20стенд.md), [54-ФЗ](/demo/54-fz.md)

Тестирование оплаты
===================

> Внимание! В настоящий момент в демо среде не работает оплата кошельком. Для тестирования используйте оплату демо-картой. Это статус на момент 16.04.2019.

### Требования к тестированию

```diff
+ в демо среде доступна оплата демо-картой и демо-наличными через демо-терминал
- в демо среде НЕ доступны все остальные методы (Сбербанк-онлайн, Мастерпас и т.д.); демо-кошелек временно не работает
```

1. Вы должны выполнить **успешный платеж** в демо-среде методом "Банковская карта". Если работает платеж хотя бы одним методом (например, метод "Банковская карта"), значит остальные методы тоже будут работать.
2. Требования к тестовому платежу
   * Платеж должен быть выполнен с использованием ваших shopid и scid предназначенных для демо-режима (мы присылаем вам письмо с четким указанием, что вот эти идентификаторы для демо-режима; при выходе в боевой режим, в другом письме, мы тоже пишем, что идентификаторы, они именно для боевого режима).
   * Если в демо платеж успешный, это и будет результатом, после которого вам включат боевой режим (главное сообщите нам о том, что в демо вы выполнили успешный платеж).
     * :e-mail: После проведения успешного платежа, напишите об этом в ответ на письмо нашим техникам (техник проверит корректность тестовой оплаты, сообщит об успехе менеджеру, менеджер проверит юридические вопросы и если все в порядке, включит боевой режим платежей, а техник яндекс.кассы из группы интеграции напишет вам письмо с указанием идентификаторов для боевых платежей и инструкцию по включению боевых платежей на вашем сайте).
     * :mag: Если во время платежа в демо-среде возникнет **ошибка**, см. раздел [решение ошибок](/demo/031%20решение%20ошибок.md).

## :moneybag: Как провести тестирование в демо

### Создайте товар для оплаты

Для тестирования оплаты нужно, чтобы в вашем магазине был товар или услуга. Создайте их с помощью вашей системы (самописный сайт или модуль магазина в CMS или SaaS системе, которую вы используйте). По вопросу "как создать товар" обратитесь к специалисту или программисту, который делает ваш электронный магазин или к документации по используемому на вашем сайте модулю электронного-магазина или к технической поддержке данной системы.

> Обратите внимание, что в стоимости товара должно быть два знака после точки (в нашем синтаксисе протокола мы используем разделитель точка `sum="100.00"`). :paw_prints:

### Лимиты суммы оплаты
У каждого платежного метода есть свои лимиты (минимальный и максимальный размер суммы). Например, оплата Яндекс.Кошельком с идентификацией уровня "Анонимный" может быть от 1 руб. до 15 тыс.рублей. Лимиты одинаковы как в демо среде, так и в боевой. См. [таблица лимитов платежных методов](https://money.yandex.ru/doc.xml?id=527483&ncrnd=6790). Если сумма не будет проходить по лимитам, мы сообщим об этом плательщику на странице оплаты. В демо-среде рекомендуем тестировать не большими суммами, например, 100 руб. `sum="100.00"`.

### :credit_card: Тестовая демо банковская карта
* карта 4444 4444 4444 4448;
* действует до: 12/20 (т.е. декабря 2020 года);
* cvv 000;
* тестовую карту не нужно пополнять демо-деньгами, они там есть всегда.

<!--
### Настоящая банковская карта
Вы можете при тестировании использовать свою настоящую карту. Средств с нее списано не будет.
-->

### Тестовый демо-кошелек

> Внимание! В настоящий момент в демо среде не работает оплата кошельком. Для тестирования используйте оплату демо-картой. Это статус на момент 16.04.2019.
```diff
+ Для оплаты кошельком, вы должны обязательно его зарегистрировать и залогиниться в него
- если инициировать оплату демо-кошельком не создав его и не залогинившись в него, то на странице оплаты
- не будет доступна оплата кошельком
```

1. **Создайте свой тестовый кошелек** за 1 минуту:
  * зарегистрируйте себе яндекс-кошелек в https://money.yandex.ru (если он есть, авторизуйтесь в него)
  * пройдите по ссылке https://demomoney.yandex.ru/reg/ (вы сможете сделать себе тестовый кошелек, если у вас уже есть учетная запись в яндекс; если ее нет, ее надо создать, чтобы затем получить персональный тестовый кошелек; обратите внимание, что в демо режиме кошелек всегда будет с [минимальной идентификации](https://money.yandex.ru/security/identification/) уровня "Анонимный").
2. **Пополнить тестовый кошелек**: перейдите по ссылке https://demomoney.yandex.ru/shop.xml?scid=50215, введите номер своего кошелька и сумму (номер кошелька можно узнать, нажав на кнопке кошелька в верхнем правом углу экрана).

#### Отрицательный баланс на кошельке
![отрицательный баланс на кошельке](/demo/отрицательный%20баланс%20на%20демо%20кошельке.png "отрицательный баланс на кошельке")

Демо платежи доступны даже при отрицательном балансе на вашем демо-кошельке.

### Тестовая оплата демо-наличными через терминал
Выберите оплату наличными через терминал, напишите номер телефона в формате `+71231231212` (также можно указать адрес электронной почты) и нажмите "Продолжить". Далее на экран вы получите код (кроме того, код придет на указанный вами телефон в виде смс; если вы указали e-mail, то код придет на почту). Далее, вместо того, чтобы пойти и ввести полученный код в терминал, используйте наш [тестовый терминал](https://demomoney.yandex.ru/shop.xml?scid=50215). Введите в нем полученный код и сумму платежа (она должна совпадать с той суммой, на которую нужно оплатить заказ в вашем тестовом магазине). Все, платеж выполнен.
