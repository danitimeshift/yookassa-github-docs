<!--
> [шаги интеграции](#Начало-интеграции), [общий план](#Общий-план), [установка](#Шаг-1-Установка-включение-платежного-модуля), [настройка](#Шаг-2-Настройка-платежного-модуля), [curl](#Пример-curl-эмулирующий-наш-запрос-на-ваш-checkurl), [тестирование](#Шаг-3-Тестирование)
-->
[![яндекс касса](/i/yakassalogo.png "Яндекс Касса")](https://kassa.yandex.ru) / документация / [http](/demo/010%20интеграция%20для%20самописных%20сайтов.md), [cms](/demo/011%20интеграция%20для%20CMS%20и%20SaaS.md):arrow_left:, [email](/010%20интеграция%20email.md), [тестирование](/demo/030%20тестирование.md), [решение ошибок](/demo/031%20решение%20ошибок.md), [демо](/demo/032%20демо%20стенд.md), [54-ФЗ](/demo/54-fz.md)

:mortar_board: Интеграция оплаты в Яндекс.Кассе с помощью готового платежного модуля
====================================================================================

**#инструкция для сайтов, созданных на основе CMS или SaaS-решений, тестовый режим**

### Требования к интеграции
- [x]  [Зарегистрируйтесь в Яндекс.Кассе](https://money.yandex.ru/joinups/) (доступно только для юридических лиц и ИП);
- [x]  Заполните нашу [техническую анкету](https://tech.yandex.ru/money/doc/payment-solution/shop-config/intro-docpage/);
- [ ] Ваш сайт должен поддерживать работу по HTTPS протоколу ([требования](/demo/040%20требования%20к%20HTTPS%20протоколу%20и%20SSL%20сертификату.md));
- [ ]  Платежный модуль должен быть установлен или включен (если модуль встроенный) и настроен на тестовые платежи. [Список модулей](https://kassa.yandex.ru/integration/#module)
- [x] Получите от нас идентификаторы **shopId** и **scid**:

> **shopId** (идентификатор магазина) = **100500**  
> **scid** (номер витрины) = **555777**  
> _это пример идентификаторов из письма; для начала интеграции необходимы **shopId** и **scid**, вы получите их в письме после того, как менеджер Яндекс.Кассы выполнит процесс вашей регистрации_

---

### Общий план

1. Установите или включите платежный модуль в CMS.
2. Пропишите в настройках **shopId**, **scid**, **[shopPassword](/demo/shopPassword-теханкета-ЛК-Кассы.png)** и включите "тестовый режим".
3. Выполните [тестирование оплаты](/demo/030%20тестирование.md).
4. После успешной оплаты в "тестовом режиме", напишите нам и мы переведем вас в боевой режим.
5. Если при тестировании возникнут ошибки и информации в разделе [решение ошибок при тестировании](/demo/031%20решение%20ошибок.md) будет не достаточно, напишите нам.

### Шаг 1. Установка (включение) платежного модуля

1. Выберите нужную CMS из списка ([список модулей](https://kassa.yandex.ru/integration/#module)). Обратите внимание, что на странице где вы будете искать нужный вам модуль, все они сгруппированы по вкладкам CMS/Saas, CRM, Фреймворк, Мессенжеры, поэтому при поиске смотрите нужную вам вкладку. Кроме того, можно воспользоваться поиском.
2. Установите или включите платежный модуль.

### Шаг 2. Настройка платежного модуля

1. Выполните настройку согласно инструкции.
2. Пропишите в настройках **shopId**, **scid**, **shopPassword** и включите "тестовый режим".
3. В настройках оплаты выберите "Выбор способа оплаты на стороне Яндекс.Кассы" (т.н. метод "[Заплати через Яндекс](/demo/022%20заплатить%20через%20яндекс.md)").

Дополнительно:

* shopPassword - это пароль, который вы записали в нашей технической анкете при регистрации в Яндекс.Кассе; данный пароль является частью защитного механизма при передаче данных (это не пароль от Личного Кабинета Яндекс.Кассы или пароль от вашего почтового ящика); :paw_prints:
* значение shopPassword, которое мы используем при подсчете MD5, хранится у нас в настройках вашего shopId;
* invoiceId - номер платежа в системе Яндекс.Касса (это наш основной идентификатор всех платежей; в Личном Кабинете при просмотре списка платежей вы будете видеть для каждого платежа свой уникальный номер; обратите внимание, что в ЛК не отображаются демо платежи).

##### Пример CURL, эмулирующий наш запрос на ваш checkURL

Если вы программист или техник, которому необходимо протестировать ответ колбеков, это можно сделать так. Ссылку на конкретный колбек можно узнать в инструкции по платежному модулю или посмотреть в настройках модуля.

```bash
curl -kvd 'action=checkOrder&shopId=100500&scid=555777&customerNumber=32&cdd_pan_mask=444444|4448 \
&orderNumber=38&paymentType=AC&invoiceId=2000000833650&shopSumAmount=100.00&md5=2A409E2B81D7A77A2B745A2F62916C42 \
&orderSumAmount=3200.00&cdd_exp_date=1217&paymentPayerCode=4100322062290&cdd_rrn=&external_id=deposit \
&requestDatetime=2016-07-11T15:29:35.438+03:00&depositNumber=tNGTnJmP7sPdWnPiSeOXLUFLB5MZ.001f.201607 \
&cps_user_country_code=PL&orderCreatedDatetime=2016-07-11T15:29:35.360+03:00&sk=yed009c9df4e4f0a47d15e20d4af3231e \
&shopSumBankPaycash=1003&shopSumCurrencyPaycash=10643&rebillingOn=false&orderSumBankPaycash=1003&cps_region_id=213 \
&orderSumCurrencyPaycash=10643&merchant_order_id=38_110716152918_00000_64759 \
&unilabel=1f15a4dd-0009-5000-8000-0000116d476c&yandexPaymentId=2570052456918' https://yousite/checkURL-script.php
```

### Шаг 3. Тестирование

* :moneybag: [Как выполнить тестирование оплаты](/demo/030%20тестирование.md)
* :mag: [Решение ошибок](/demo/031%20решение%20ошибок.md)
* :ferris_wheel: [Демонстрационный стенд](/demo/032%20демо%20стенд.md)
